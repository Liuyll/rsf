{"version":3,"file":"rsf.esm.js","sources":["../src/utils.ts","../src/cache.ts","../src/context.ts","../src/boundary.tsx","../src/fetch.ts","../src/hooks.ts"],"sourcesContent":["const hasOwn = Object.prototype.hasOwnProperty\r\n\r\nfunction is(x, y) {\r\n  if (x === y) {\r\n    return x !== 0 || y !== 0 || 1 / x === 1 / y\r\n  } else {\r\n    return x !== x && y !== y\r\n  }\r\n}\r\n\r\nexport function shallowEqual(objA, objB) {\r\n  if (is(objA, objB)) return true\r\n\r\n  if (typeof objA !== 'object' || objA === null ||\r\n      typeof objB !== 'object' || objB === null) {\r\n    return false\r\n  }\r\n\r\n  const keysA = Object.keys(objA)\r\n  const keysB = Object.keys(objB)\r\n\r\n  if (keysA.length !== keysB.length) return false\r\n\r\n  for (let i = 0; i < keysA.length; i++) {\r\n    if (!hasOwn.call(objB, keysA[i]) ||\r\n        !is(objA[keysA[i]], objB[keysA[i]])) {\r\n      return false\r\n    }\r\n  }\r\n\r\n  return true\r\n}","import { shallowEqual } from './utils'\r\n\r\ntype Params = any[]\r\ntype Data = any\r\ninterface IValueRepo {\r\n    [key:string]: Data\r\n}\r\n\r\ntype EasyCache = Map<string | Function, any>\r\ntype ComplicatedCache = Map<Function, Map<Params, any>>\r\n\r\ninterface IGetComplicatedCache {\r\n    (fnCache: Map<Params, Data>, args: any[]): any\r\n    (fnCache: Map<Params, Data>, args: any[], needParams: true): Params \r\n}\r\n\r\ninterface ICacheRepo {\r\n    isFunctionCacheMode:boolean\r\n    get(fn: Function, args ?: any[]): Data | undefined\r\n    clear(fn:Function,args ?: any[]): any\r\n    set(fn:Function, data:any, args ?: any[], options ?: ICacheOptions): any\r\n}\r\n\r\ninterface IFetchRepo {\r\n    isFunctionCacheMode:boolean\r\n    get(fn: Function, args ?: any[]): any\r\n    set(fn:Function, data:any, args ?: any[], options ?: ICacheOptions): any\r\n}\r\n\r\ninterface ICacheOptions {\r\n    expire: number\r\n    expireTime: number | Date\r\n}\r\n\r\ninterface IFetchFuture {\r\n    get(): any \r\n}\r\n\r\nconst isComplicatedParams = (params: Params) => \r\n    params.some(p => (typeof p === 'object' && p != null) || typeof p === 'function')\r\n\r\nconst genCacheString = (fn: Function, args: any[]) => \r\n    fn.toString() + args.toString()\r\n    \r\n\r\nclass CacheRepo implements ICacheRepo {\r\n    private repo: Map<Function | string, Data> = new Map()\r\n    private complicatedParamRepo: Map<Function, Map<Params, Data>> = new Map()\r\n    private valueRepo: IValueRepo = {} \r\n    isFunctionCacheMode:boolean\r\n\r\n    constructor(isFunctionCacheMode:boolean = false) {\r\n        this.isFunctionCacheMode = isFunctionCacheMode\r\n    }\r\n\r\n    set(fn:Function, data:any, args: any[] = [], options ?: ICacheOptions) {\r\n        if(options.expire) {\r\n            data.__cache_expire = options.expire\r\n            data.__cache_start = new Date().getTime()\r\n        } \r\n        if(options.expireTime) {\r\n            data.__cache_expireTime = options.expireTime\r\n        }\r\n        setToCache(fn, this.isFunctionCacheMode, data, this.repo, this.complicatedParamRepo, args)\r\n    }\r\n\r\n    clear(fn:Function,args: any[] = []) {\r\n        clearFromCache(fn, this.isFunctionCacheMode, args, this.repo, this.complicatedParamRepo)\r\n    }\r\n\r\n    get(fn: Function, args : any[] = []): Data | undefined {\r\n        const data = getFromCache(fn, args, this.isFunctionCacheMode, this.repo, this.complicatedParamRepo)\r\n        return data\r\n    }\r\n}\r\n\r\nclass FetchRepo implements IFetchRepo {\r\n    private repo: Map<Function | string, IFetchFuture> = new Map()\r\n    private complicatedParamRepo: Map<Function, Map<Params, IFetchFuture>> = new Map()\r\n    isFunctionCacheMode:boolean\r\n    \r\n    constructor(isFunctionCacheMode: boolean) {\r\n        this.isFunctionCacheMode = isFunctionCacheMode\r\n    }\r\n\r\n    get(fn: Function, args ?: any[]): any {\r\n        const future = getFromCache(fn, args, this.isFunctionCacheMode, this.repo, this.complicatedParamRepo)\r\n        return future\r\n    }\r\n\r\n    set(fn:Function, ret:any, args: any[] = []): any {\r\n        setToCache(fn, this.isFunctionCacheMode, ret, this.repo, this.complicatedParamRepo, args)\r\n    }\r\n\r\n    clear(fn:Function, args: any[] = []) {\r\n        clearFromCache(fn, this.isFunctionCacheMode, args, this.repo, this.complicatedParamRepo)\r\n    }\r\n}\r\n\r\nconst handleExpireData = (data: any) => {\r\n    if(!data) return data\r\n    const currentTimeStamp = new Date().getTime()\r\n\r\n    if(data.__cache_expire) {\r\n        if(data.__cache_start + data.__cache_expire < currentTimeStamp) return null\r\n        const handledData = JSON.parse(JSON.stringify(data))\r\n        delete handledData.__cache_expire\r\n        delete handledData.__cache_start\r\n        return handledData\r\n    } else if(data.__cache_expireTime) {\r\n        if(currentTimeStamp > data.__cache_expireTime) return null\r\n        const handledData = JSON.parse(JSON.stringify(data))\r\n        delete handledData.__cache_expireTime\r\n        return handledData\r\n    }\r\n\r\n    return data\r\n}\r\n\r\nconst getComplicatedCache:IGetComplicatedCache = (fnCache: Map<Params, Data>, args: any[]) => {\r\n    if(!fnCache) return null\r\n    try {\r\n        fnCache.forEach((data, cacheParams) => {\r\n            if(shallowEqual(cacheParams, args)) throw data\r\n        })\r\n    } catch(data) {\r\n        return handleExpireData(data)\r\n    }\r\n    return null\r\n}\r\n\r\nconst getFromCache = (fn: Function, args: any[], isFunctionCacheMode: boolean, cache: EasyCache, complicatedCache: ComplicatedCache) => {\r\n    if(isFunctionCacheMode) return handleExpireData(cache.get(fn))\r\n    if(isComplicatedParams(args)) {\r\n        const fnCache = complicatedCache.get(fn)\r\n        getComplicatedCache(fnCache, args)\r\n    }\r\n    return handleExpireData(cache.get(genCacheString(fn, args)))\r\n}\r\n\r\nconst setToCache = (fn:Function, isFunctionCacheMode: boolean, ret: any, cache: EasyCache, complicatedCache: ComplicatedCache, args: any[] = []) => {\r\n    if(isFunctionCacheMode) {\r\n        cache.set(fn, ret)\r\n    } else {\r\n        if(isComplicatedParams(args)) {\r\n            const fnCache = complicatedCache.get(fn)\r\n            if(!fnCache) complicatedCache.set(fn, new Map([[args, ret]]))\r\n            else fnCache.set(args, ret)\r\n        }\r\n        else cache.set(genCacheString(fn, args), ret)\r\n    }\r\n}\r\n\r\nconst clearFromCache = (fn:Function, isFunctionCacheMode: boolean, args: any[] = [], cache: EasyCache, complicatedCache: ComplicatedCache) => {\r\n    if(isFunctionCacheMode) cache.delete(fn)\r\n    else {\r\n        if(isComplicatedParams(args)) {\r\n            const fnCache = complicatedCache.get(fn)\r\n            const params = getComplicatedCache(fnCache, args, true)\r\n            fnCache.delete(params)\r\n        }\r\n        cache.delete(genCacheString(fn, args))\r\n    }\r\n}\r\n\r\nexport {\r\n    CacheRepo,\r\n    FetchRepo,\r\n    ICacheRepo\r\n}\r\n\r\n","import { createContext } from 'react'\r\nimport { CacheRepo, FetchRepo } from './cache'\r\n\r\nconst makeInitRepo = (isFunctionCacheMode: boolean) => ({\r\n    cacheRepo: new CacheRepo(isFunctionCacheMode),\r\n    fetchRepo: new FetchRepo(isFunctionCacheMode)\r\n})\r\n\r\ninterface IContextRepo {\r\n    cacheRepo: CacheRepo\r\n    fetchRepo: FetchRepo\r\n}\r\n\r\nconst Context = createContext(makeInitRepo(false))\r\nconst Provider = Context.Provider\r\n\r\nexport {\r\n    Context,\r\n    Provider,\r\n    makeInitRepo,\r\n    IContextRepo\r\n}","import * as React from 'react'\r\nimport { Suspense } from 'react'\r\nimport { makeInitRepo, Provider } from './context'\r\nimport { CacheRepo } from './cache'\r\n\r\ninterface IBoundaryState {\r\n    loading: React.ReactNode\r\n    render: React.ReactNode\r\n    err: boolean\r\n    isFunctionCacheMode: boolean\r\n}\r\n\r\ninterface IBoundaryOptions {\r\n    loading: React.ReactNode\r\n    children: React.ReactNode\r\n    error ?: React.ReactNode | Function\r\n    isFunctionCacheMode ?: boolean\r\n}\r\n\r\nclass Boundary extends React.Component<IBoundaryOptions, IBoundaryState> {\r\n    private error: React.ReactNode | Function\r\n    constructor(options: IBoundaryOptions) {\r\n        super(options)\r\n        let { \r\n            loading,\r\n            children,\r\n            error,\r\n            isFunctionCacheMode = false,\r\n        } = options \r\n\r\n        this.state = {\r\n            loading,\r\n            render: children,\r\n            err: false,\r\n            isFunctionCacheMode\r\n        }\r\n        this.error = error\r\n    }\r\n\r\n    static getDerivedStateFromError(err) {\r\n        return {\r\n            err: true\r\n        }\r\n    }\r\n\r\n    componentDidCatch(err) {\r\n        if(typeof this.error === 'function') {\r\n            this.error = this.error(err)\r\n        }\r\n    }\r\n    \r\n    render() {\r\n        return (\r\n            <Provider value={makeInitRepo(this.state.isFunctionCacheMode)}>\r\n                <Suspense fallback={this.state.loading}>\r\n                    {this.state.err ? this.error : this.state.render}\r\n                </Suspense>\r\n            </Provider>\r\n        )\r\n    }\r\n}\r\n\r\nexport {\r\n    Boundary\r\n}\r\n","import { useContext } from 'react'\r\nimport { Context, IContextRepo } from './context'\r\n\r\ntype Data = any\r\ntype Refresh = Function\r\ntype FetchResult = [Data, Refresh]\r\n\r\ntype PromiseStatus = 'pending' | 'resolve' | 'reject'\r\ninterface IFuture {\r\n    get:() => void\r\n}\r\n\r\ninterface IOptions {\r\n    fetch: (...args:any[]) => Promise<any>\r\n    args ?: any[]\r\n    expire ?: number\r\n    expireTime ?: Date | number\r\n}\r\n\r\nconst handleParams = (fetch: (...args:any[]) => Promise<any>, args: any[], options ?: IOptions):IOptions => {\r\n    let _options: IOptions\r\n    if(typeof fetch === 'object') _options = fetch\r\n    else if(typeof args === 'object' && !Array.isArray(args)) _options = {\r\n        ...(args as Object),\r\n        fetch\r\n    }\r\n    else if(typeof options === 'object' || options === undefined) _options = {\r\n        ...options ? options : {},\r\n        args,\r\n        fetch\r\n    } \r\n    else throw Error('useFetch params is not satisfy!')\r\n    \r\n    if(!Array.isArray(_options.args)) throw Error(`useFetch second params --- args only accept array type or non!`)\r\n    if(typeof _options.fetch !== 'function') throw Error(`useFetch second params --- fetch only accept function type!`)\r\n\r\n    return _options\r\n    \r\n}\r\n\r\nconst _useFetch = (fetch: (...args:any[]) => Promise<any>, args: any[] = [], ):IFuture => {\r\n    let status:PromiseStatus = 'pending', \r\n        ret:any \r\n    const task = fetch(...args).then(\r\n        r => {\r\n            status = 'resolve'\r\n            ret = r\r\n        },\r\n        e => {\r\n            status = 'reject'\r\n            ret = e\r\n        }\r\n    )\r\n\r\n    return  {\r\n        get() {\r\n            if(status === 'pending') throw task\r\n            else if(status === 'resolve') return ret\r\n            else throw ret\r\n        }\r\n    }\r\n}\r\n\r\nconst useFetch = (fetch: (...args:any[]) => Promise<any>, args: any[] = [], options ?: IOptions): FetchResult => {\r\n    const params = handleParams(fetch, args, options)\r\n    fetch = params.fetch, args = params.args\r\n\r\n    const {expire, expireTime} = params\r\n    if(expire && expireTime) throw Error(`useFetch can't accept expire and expireTime simultaneously`)\r\n    const repo:IContextRepo = useContext(Context)\r\n    const {\r\n        cacheRepo,\r\n        fetchRepo\r\n    } = repo\r\n\r\n    let cache: any\r\n    let data: any\r\n\r\n    const refresh = () => {\r\n        cacheRepo.clear(fetch, args)\r\n        return useFetch(fetch, args)\r\n    }\r\n\r\n    if((cache = cacheRepo.get(fetch, args))) {\r\n        return [cache, refresh]\r\n    }\r\n\r\n    debugger\r\n    if((cache = fetchRepo.get(fetch, args))) {\r\n        data = cache.get()\r\n    } else {\r\n        const future = _useFetch(fetch, args)\r\n        fetchRepo.set(fetch, future, args)\r\n        future.get()\r\n    }\r\n    \r\n    fetchRepo.clear(fetch, args)\r\n    cacheRepo.set(fetch, data, args, {\r\n        expire,\r\n        expireTime\r\n    })\r\n   \r\n    return [data, refresh]\r\n}\r\n\r\nexport {\r\n    useFetch,\r\n    FetchResult\r\n}","import { useCallback } from 'react'\r\nimport { useDB } from 'rexos'\r\nimport { useFetch, FetchResult }from './fetch'\r\n\r\nfunction useRsf(url:string, datas: any[], options: Object):FetchResult\r\nfunction useRsf(url:string, options: Object):FetchResult\r\nfunction useRsf(options: Object):FetchResult\r\n\r\nfunction useRsf(url:string, data ?: any[] | object , options ?: Object ): FetchResult {\r\n    let _options\r\n    if(!data) {\r\n        if(typeof url === 'string') {\r\n            _options = { url }\r\n        } else {\r\n            _options = url\r\n        }\r\n    } else if(options) {\r\n        _options = options\r\n        _options.url = url\r\n        _options.data = data\r\n    } else {\r\n        if(Array.isArray(data)) {\r\n            _options = {\r\n                url,\r\n                data\r\n            } \r\n        } else {\r\n            _options = data\r\n            _options.url = url\r\n        }\r\n    }\r\n\r\n    const fetch = useCallback(() => useDB(true, _options), _options.data || [])\r\n    return useFetch(fetch)\r\n}\r\n\r\nexport {\r\n    useRsf\r\n}"],"names":["createContext","React.Component","React.createElement","Suspense","useContext","useCallback","useDB"],"mappings":"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"}